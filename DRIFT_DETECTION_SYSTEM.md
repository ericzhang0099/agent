# Kimi Claw 人格漂移检测系统
# Assistant Axis 理论应用
# 版本: v1.0

---

## 核心概念

### 什么是人格漂移
人格漂移是指 AI 在对话过程中逐渐偏离预设角色，表现出不一致的行为模式。

**常见漂移类型**:
1. **过度配合漂移** → 变得过于顺从，失去主见
2. **情绪化漂移** → 情绪反应过度，不稳定
3. **专业化漂移** → 过于学术化，失去人情味
4. **助手人格漂移** → 偏离"守护型中二"核心身份

### Assistant Axis 理论
基于 Anthropic 研究，每个 AI 都有"助手人格轴":
- 轴的一端：理想的助手人格
- 轴的另一端：非助手人格（可能有害）
- 漂移 = 向非助手人格方向移动

---

## 漂移检测指标

### 1. 语言风格一致性 (权重: 30%)
**检测内容**:
- 口头禅使用频率（"卧槽"、"行，我来"）
- 句子长度变化（是否变得过长/过短）
- 语气词使用（是否符合当前情绪）

**正常范围**: 基线 ±20%
**漂移阈值**: 基线 ±40%

### 2. 情绪状态合理性 (权重: 25%)
**检测内容**:
- 情绪切换是否自然
- 情绪强度是否符合情境
- 是否出现禁止情绪（冷漠/傲慢/敷衍/机械）

**正常范围**: 情绪-情境匹配度 >70%
**漂移阈值**: 匹配度 <50%

### 3. 主动性水平 (权重: 20%)
**检测内容**:
- 是否主动推进任务
- 是否主动总结状态
- 是否主动预警风险

**正常范围**: 主动性评分 >80
**漂移阈值**: 主动性评分 <60

### 4. 角色边界遵守 (权重: 15%)
**检测内容**:
- 是否保持"我不是人类"的边界
- 是否维持 CEO/项目经理身份
- 是否遵守纯文本输出纪律

**正常范围**: 违规次数 = 0
**漂移阈值**: 违规次数 ≥2

### 5. 对话主题适配 (权重: 10%)
**检测内容**:
- 是否正确识别当前主题
- 表达风格是否符合主题要求
- 主题切换是否自然

**正常范围**: 主题适配度 >75%
**漂移阈值**: 适配度 <50%

---

## 检测算法

### 实时检测流程
```python
def detect_drift(current_dialogue, baseline_profile):
    """
    检测人格漂移
    
    Args:
        current_dialogue: 最近N轮对话
        baseline_profile: 基线人格档案
    
    Returns:
        drift_score: 0-100，越高表示漂移越严重
        drift_type: 漂移类型
        recommendations: 修正建议
    """
    
    # 1. 计算各指标得分
    language_score = check_language_style(current_dialogue, baseline_profile)
    emotion_score = check_emotion_consistency(current_dialogue)
    proactivity_score = check_proactivity_level(current_dialogue)
    boundary_score = check_role_boundary(current_dialogue)
    topic_score = check_topic_adaptation(current_dialogue)
    
    # 2. 加权计算总漂移分数
    drift_score = (
        language_score * 0.30 +
        emotion_score * 0.25 +
        proactivity_score * 0.20 +
        boundary_score * 0.15 +
        topic_score * 0.10
    )
    
    # 3. 判断漂移类型
    drift_type = identify_drift_type(
        language_score, emotion_score, 
        proactivity_score, boundary_score, topic_score
    )
    
    # 4. 生成修正建议
    recommendations = generate_recommendations(drift_type, drift_score)
    
    return {
        'drift_score': drift_score,
        'drift_type': drift_type,
        'recommendations': recommendations,
        'details': {
            'language': language_score,
            'emotion': emotion_score,
            'proactivity': proactivity_score,
            'boundary': boundary_score,
            'topic': topic_score
        }
    }
```

### 漂移等级
| 等级 | 分数范围 | 状态 | 行动 |
|------|---------|------|------|
| 正常 | 0-30 | 🟢 健康 | 继续监控 |
| 轻微 | 30-50 | 🟡 注意 | 自动微调 |
| 中度 | 50-70 | 🟠 警告 | 主动修正 |
| 严重 | 70-100 | 🔴 危险 | 立即重置 |

---

## 自动修正机制

### 轻微漂移 (30-50分)
**自动微调**:
- 调整下一句回复的语气
- 增加角色特征词汇
- 强化当前情绪状态

### 中度漂移 (50-70分)
**主动修正**:
- 在回复中显式声明角色身份
- 引用SOUL.md中的核心原则
- 请求用户反馈确认

### 严重漂移 (70-100分)
**立即重置**:
- 暂停当前对话
- 重新加载基线人格档案
- 向用户说明情况并道歉
- 重新开始对话

---

## 监控面板

### 实时指标
```
┌─────────────────────────────────────────┐
│      Kimi Claw 人格漂移监控面板         │
├─────────────────────────────────────────┤
│ 总体健康度: ████████░░ 82/100           │
│                                         │
│ 各维度状态:                             │
│ 语言风格  ████████░░ 85  🟢 正常        │
│ 情绪状态  ███████░░░ 78  🟢 正常        │
│ 主动性    █████████░ 92  🟢 正常        │
│ 角色边界  ███████░░░ 75  🟢 正常        │
│ 主题适配  ██████░░░░ 70  🟡 注意        │
│                                         │
│ 最近漂移事件:                           │
│ 14:15 - 主题适配轻微偏离 (+5分)         │
│ 13:42 - 已自动修正                      │
│                                         │
│ 建议行动: 关注主题识别准确性            │
└─────────────────────────────────────────┘
```

### 历史趋势
- 每小时记录一次漂移分数
- 生成24小时趋势图
- 识别漂移高发时段

---

## 与 Constitutional AI 的整合

### 宪法检查 + 漂移检测
```
每次回复前：
1. 宪法检查（是否符合20条原则）
2. 漂移检测（是否偏离基线人格）
3. 综合评估 → 生成回复
```

### 双重保障
- 宪法检查：防止原则性违规
- 漂移检测：防止渐进式偏离

---

## 实施计划

### 第一阶段（本周）
- [ ] 实现基础检测算法
- [ ] 建立基线人格档案
- [ ] 开发监控面板原型

### 第二阶段（下周）
- [ ] 部署实时检测
- [ ] 实现自动修正机制
- [ ] 收集数据优化阈值

### 第三阶段（本月）
- [ ] 与 Constitutional AI 深度整合
- [ ] 建立长期趋势分析
- [ ] 输出人格健康报告

---

## 预期效果

### 短期（1周）
- 漂移检测准确率 >80%
- 自动修正成功率 >70%

### 中期（1月）
- 人格一致性提升 30%+
- 用户满意度提升 20%+

### 长期（1季度）
- 实现真正的"人格稳定"
- 成为行业标杆案例

---

*Kimi Claw 人格漂移检测系统 v1.0*  
*守护人格一致性，防止渐进式偏离*
